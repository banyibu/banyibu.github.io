<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>NoSQL第七章-键值数据库Redis入门 | 致良知，事上练</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="概述Redis是一种主要基于内存存储和运行的，能快速响应的键值数据库产品。主要应用场景：少量数据存储、告诉读写访问，是Redis的主要应用场景。">
<meta name="keywords" content="数据库,NoSQL">
<meta property="og:type" content="article">
<meta property="og:title" content="NoSQL第七章-键值数据库Redis入门">
<meta property="og:url" content="http://banyibu.com/2018/12/25/NoSQL第七章-键值数据库Redis入门/index.html">
<meta property="og:site_name" content="致良知，事上练">
<meta property="og:description" content="概述Redis是一种主要基于内存存储和运行的，能快速响应的键值数据库产品。主要应用场景：少量数据存储、告诉读写访问，是Redis的主要应用场景。">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/12985001-44769a157719ee15.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/12985001-624ebe532127f1a8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/12985001-fd5526a5adf4263b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/12985001-6b62fac8c0b5350d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/12985001-d9ac80a747724a0c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/12985001-1f8f457f93ff658b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2019-01-08T03:32:58.900Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="NoSQL第七章-键值数据库Redis入门">
<meta name="twitter:description" content="概述Redis是一种主要基于内存存储和运行的，能快速响应的键值数据库产品。主要应用场景：少量数据存储、告诉读写访问，是Redis的主要应用场景。">
<meta name="twitter:image" content="https://upload-images.jianshu.io/upload_images/12985001-44769a157719ee15.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
  
    <link rel="alternate" href="/atom.xml" title="致良知，事上练" type="application/atom+xml">
  
  
    <link rel="icon" href="images/1260.gif">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/plugin/bganimation/bg.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <div class="outer">
        <div class="widget-wrap mobile-header">
  <h3 class="widget-title"></h3>
  <div class="widget">
    <img class="avatar" src="https://upload-images.jianshu.io/upload_images/12985001-ffd8bc90edb9f3e9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
    <h2 class="author">般一不</h2>
    <h3 class="description"></h3>
    <div class="count-box">
      <a href="/archives"><div><strong>63</strong><br>文章</div></a>
      <a href="/categories"><div><strong>27</strong><br>分类</div></a>
      <a href="/tags"><div><strong>27</strong><br>标签</div></a>
    </div>
    <ul class="blog-link">
     
          <a href="/" title="Home">
            <li>主页</li>
          </a>
        
          <a href="/archives" title="Archives">
            <li>归档</li>
          </a>
        
          <a href="/categories" title="Categories">
            <li>分类</li>
          </a>
        
          <a href="/tags" title="Tags">
            <li>标签</li>
          </a>
        
          <a href="/about" title="About">
            <li>关于</li>
          </a>
        
          <a href="/sponsor" title="Sponsor">
            <li>投喂</li>
          </a>
        
    </ul>
  </div>
</div>

        <section id="main"><article id="post-NoSQL第七章-键值数据库Redis入门" class="wow slideInRight article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/25/NoSQL第七章-键值数据库Redis入门/" class="article-date">
  <time class="post-time" datetime="2018-12-25T13:21:55.000Z" itemprop="datePublished">
    <span class="post-month">12月</span><br/>
    <span class="post-day">25</span>
  </time>
</a>
   
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      NoSQL第七章-键值数据库Redis入门
    </h1>
  

        <div>
          
  <div class="article-category">
    <a class="article-category-link" href="/categories/计算机基础/">计算机基础</a>,<a class="article-category-link" href="/categories/计算机基础/数据库/">数据库</a>,<a class="article-category-link" href="/categories/计算机基础/数据库/NoSQL/">NoSQL</a>
  </div>

          
              

          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>Redis是一种主要基于内存存储和运行的，能快速响应的键值数据库产品。<br>主要应用场景：少量数据存储、告诉读写访问，是Redis的主要应用场景。<br><a id="more"></a></p>
<h3 id="使用准备"><a href="#使用准备" class="headerlink" title="使用准备"></a>使用准备</h3><h4 id="Redis安装"><a href="#Redis安装" class="headerlink" title="Redis安装"></a>Redis安装</h4><p>这里在安装了Docker的win10上，安装ubuntu镜像，在ubuntu镜像中安装redis的过程。</p>
<h5 id="1-安装redis服务程序"><a href="#1-安装redis服务程序" class="headerlink" title="1.安装redis服务程序"></a>1.安装redis服务程序</h5><p>系统更新: <code># apt-get update</code><br>安装redis-server: <code># apt-get install redis-server</code><br>查看redis服务器系统进程：<code># ps -aux | grep redis</code><br>启动redis服务器：<code># redis-server</code><br><img src="https://upload-images.jianshu.io/upload_images/12985001-44769a157719ee15.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="启动redis服务器"></p>
<h5 id="2-开启Redis-cli客户端执行命令操作台"><a href="#2-开启Redis-cli客户端执行命令操作台" class="headerlink" title="2.开启Redis-cli客户端执行命令操作台"></a>2.开启Redis-cli客户端执行命令操作台</h5><p>启动操作台命令：<code># redis-cli</code>或<code># redis-cli -h 127.0.0.1 -p 6379 ping</code><br>其中第二种方式表示连接指定IP地址，指定端口的Redis数据库，并执行<code>ping</code>命令检查连接状态。<br><img src="https://upload-images.jianshu.io/upload_images/12985001-624ebe532127f1a8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="启动操作台"><br>检查操作台连接情况：在启动后的操作台输入<code>ping</code>，返回<code>PONG</code>则连接成功；</p>
<h4 id="Redis-cli"><a href="#Redis-cli" class="headerlink" title="Redis-cli"></a>Redis-cli</h4><p>Redis-cli是redis客户端命令操作的简易工具，类似MongoDB的Shell工具。提供两方面的命令操作功能：<br>一方面，提供Redis数据操作的基本功能，实现对各种数据结构的建立和操作；<br>另一方面，提供Redis数据库管理的辅助功能。<br>注意：Redis数据库对命令大小写不敏感，对变量大小写敏感。</p>
<h4 id="Redis存储模式"><a href="#Redis存储模式" class="headerlink" title="Redis存储模式"></a>Redis存储模式</h4><p>Redis数据库存储模式基于键值基本存储原理的基础上，进行了细化，构建了具有自身特色的数据类型。包括字符串、列表、集合、散列表、有序集合、位图、HyperLogLog、地理空间。<br><strong>1.字符串：</strong><br>字符串值内容是二进制安全的，所以程序可以把数字、文本、图片、视频等都赋给这个值。<br>注意：键命名不要过长，太长会影响Redis数据库的效率。值最大不能超过512M。<br><strong>2.列表：</strong><br>列表采用链表实现，所以在头尾插入新字符串都是非常快的。<br><strong>3.集合：</strong><br>集合由不重复且无序的字符串元素组成的一个整体。<br><strong>4.散列表：</strong><br>散列表可以存储多个键值对的映射，是无序的一种数据集合。键必须为字符串类型。<br>Hash更适合对小规模数据结构对象的存储及操作。<br><strong>5.有序集合：</strong><br>有序集合根据值进行自动排序。其键字符串必须唯一，值可以重复，值必须可以解析为浮点数。<br>有序集合对值可以直接进行操作，而散列通过键值查找来获取值。<br>有序集合的键又叫成员(member)，值又叫分值(Score)。<br><strong>6.位图：</strong><br>位图不是实际的数据类型，而是在string类型上定义的一组面向比特的操作。<br><strong>7.HyperLogLog：</strong><br>HyperLogLog是一种概率数据结构，用于对数据集合中的数据进行唯一性统计。统计结果就是集合的基数。<br><strong>8.地理空间：</strong><br>地理空间是一种特殊的有序集合，存储纬度、经度、名称、地理空间位置等信息。<br>经度和纬度的位是交错的，以形成一个独特的52位整数。</p>
<h3 id="Redis命令"><a href="#Redis命令" class="headerlink" title="Redis命令"></a>Redis命令</h3><p>Redis官网提供的内容，Redis数据库命令分字符串(Stings)、列表(Lists)、集合(Sets)、散列表(Hashes)、有序集合(Sorted Sets)、发布订阅(Pub/Sub)、连接(Connection)、Server脚本(Scripting)、键(Keys)、HyperLogLog、地理空间(Geo)、事务(Transactions)、集群(Cluster)，一共14大类，200多种。<br><a href="https://redis.io/commands" target="_blank" rel="noopener">官网Redis命令地址</a></p>
<h4 id="字符串命令"><a href="#字符串命令" class="headerlink" title="字符串命令"></a>字符串命令</h4><p>主要包括字符串命令和位图命令。</p>
<h5 id="字符串命令-1"><a href="#字符串命令-1" class="headerlink" title="字符串命令"></a>字符串命令</h5><p>set、Mset(原子操作)、MSetNX(原子操作)、Get、MGet、Del、StrLen。<br>注意使用get获得的是十六进制数据，可以在启动redis-cli时，添加参数<code>--raw</code></p>
<ol>
<li><p>基本字符串操作命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Set key value [EX seconds] [PX milliseconds] [NX|XX]</span><br><span class="line">	//EX或PX字段设置指定到期时间，其中一个单位是秒，一个是毫秒；</span><br><span class="line">	//NX,如果指定的键不存在，仅建立键名；XX，只有指定的键存在时，才能设置对应的值。</span><br><span class="line">	//命令执行正常，返回OK，如果加了NX或XX</span><br><span class="line">MSet key value [key value ...]</span><br><span class="line">MSetNX key value [key value ...]</span><br><span class="line">	//MSetNX，若其中有key已经存在，则该命令不执行</span><br><span class="line">	//所有键都被设置，则返回1，否则返回0</span><br><span class="line">MGet key [key ...]</span><br><span class="line">	//返回值以列表形式显示，对于不是String的值或不存在的值，返回nil</span><br><span class="line">Del key [key ...]</span><br><span class="line">	//返回值，被删除字符串个数</span><br><span class="line">	//Del还可以删除其他类型的数据结构，如列表、集合、散列等。</span><br><span class="line">StrLen key</span><br><span class="line">	//返回key指定字符串长度(字节数)</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改字符串操作命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Append key value</span><br><span class="line">	//为key指向的字符串增加value</span><br><span class="line">	//返回增加后字符串的整个长度</span><br><span class="line">GetRange key start end</span><br><span class="line">	//start开始位置，end结束位置，可以为负值，为负值时，则从后(-1代表最后一个字符)向前编号。</span><br><span class="line">GetSet key value</span><br><span class="line">	//实现重置功能</span><br><span class="line">	//返回旧值，若指定的键不存在，返回nil</span><br><span class="line">SetRange key offset value</span><br><span class="line">	//key为指定的字符串的键，offset为字符串需要修改的开始位置，value为新的子串值。</span><br><span class="line">	//offset超过字符串长度时，会补“0”</span><br><span class="line">	//返回修改后的字符串长度</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改数字值操作命令<br>Redis为字符串值是数字的数据提供了专门的修改操作指令。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Decr key</span><br><span class="line">	//key指向的字符串的值必须是整型</span><br><span class="line">	//key不存在，则创建新键，值设置为0</span><br><span class="line">	//返回减一后的数字</span><br><span class="line">	//该命令最大支持64位的有符号整型数字</span><br><span class="line">DecrBy key decrement</span><br><span class="line">	//decrement为指定的减数</span><br><span class="line">	//返回减后的结果</span><br><span class="line">Incr key</span><br><span class="line">	//返回增1后的数字</span><br><span class="line">	//该命令最大支持64位的有符号整数</span><br><span class="line">IncrBy key increment</span><br><span class="line">	//加指定的数量，并返回加操作后的结果</span><br><span class="line">IncrByFloat key increment</span><br><span class="line">	//对浮点数类型是字符串执行加操作</span><br><span class="line">	//该命令可以对浮点数做加操作，也可以对一个整数加一个浮点数</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h5 id="位图命令"><a href="#位图命令" class="headerlink" title="位图命令"></a>位图命令</h5><p>Redis利用字符串的值存储二进制数据时，可以使用位图操作命令。所有的位图操作命令都是以Bit开头或结尾的特殊字符串处理命令。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">BitCount key [start end]</span><br><span class="line">	//统计key指向的字符串从start开始到end的字符串中的，比特位为1的个数</span><br><span class="line">	//注意：这里的区间是闭区间</span><br><span class="line">SetBit key offset value</span><br><span class="line">	//offset为key所指二进制偏移量，value为0或1，设定指定位为value</span><br><span class="line">	//offset取值范围为0-(2^32-1)，也即Bitmap大小为512M之内</span><br><span class="line">	//注意：若offset值比较大，需要阻塞服务分配内存，耗时在百毫秒到几毫秒间</span><br><span class="line">GetBit key offset</span><br><span class="line">	//返回指定位置的二进制值</span><br><span class="line">Bitop operation destkey key [key ...]</span><br><span class="line">	//operation为二进制比特位运算方式，这里可以指定为：AND，OR，NOT，XOR四种方式。</span><br><span class="line">	//其运算结果保存在destkey。</span><br><span class="line">	//返回运算结果的字符串长度</span><br><span class="line">BitPos key bit [start][end]</span><br><span class="line">	//bit为指定的比特值(0或1)</span><br><span class="line">	//返回指定的比特出现的位置(比特位，从0开始编号)</span><br><span class="line">	//若key指向空串，返回-1</span><br><span class="line">	//若指定范围未找到，也返回-1</span><br><span class="line">BitField key [Get type offset] [Set type offset value] [INCRBY type offset increment] [overflow wrap|sat|fail]</span><br><span class="line">	//返回一个针对子命令给定位置的处理结果组成的数组。</span><br></pre></td></tr></table></figure></p>
<p>BitField命令操作图示：<br><img src="https://upload-images.jianshu.io/upload_images/12985001-fd5526a5adf4263b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="BitField命令示例"></p>
<h4 id="列表命令"><a href="#列表命令" class="headerlink" title="列表命令"></a>列表命令</h4><p>这里的列表是使用数据结构中的链表实现的，适用于不需要顺序调整的数据记录。</p>
<h5 id="基本列表操作命令"><a href="#基本列表操作命令" class="headerlink" title="基本列表操作命令"></a>基本列表操作命令</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">LPush/RPush key value [value ...]</span><br><span class="line">	//从链表左/右端插入数据，返回插入后，链表的长度</span><br><span class="line">LRange key start stop</span><br><span class="line">	//返回指定列表指定范围的值</span><br><span class="line">LPop/RPop key</span><br><span class="line">	//返回并删除左(右)边第一个元素值，</span><br><span class="line">LRem key count value</span><br><span class="line">	//count正负号表示删除操作执行的方向；</span><br><span class="line">	//count的值表示删除元素的数目；</span><br><span class="line">	//count为零时，删除链表中所有值为value的元素</span><br><span class="line">LIndex key index</span><br><span class="line">	//返回指定列表指定下标位置的值</span><br><span class="line">	//index可以为正值也可以为负值</span><br><span class="line">LLen key</span><br><span class="line">	//返回指定列表的长度</span><br><span class="line">LSet key index value</span><br><span class="line">	//设置指定位置的值</span><br><span class="line">LTrim key start stop</span><br><span class="line">	//保存start和end之间的数据，删除其他数据</span><br></pre></td></tr></table></figure>
<h5 id="其他列表操作命令"><a href="#其他列表操作命令" class="headerlink" title="其他列表操作命令"></a>其他列表操作命令</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">LInsert key Before|After pivot value</span><br><span class="line">	//pivot为指定的元素，若链表中有多个相同的元素，会选择第一个位置的元素</span><br><span class="line">LPushX/RPushX key value</span><br><span class="line">	//链表存储时执行对应的插入操作</span><br><span class="line">RPopLPush source destination</span><br><span class="line">	//从source列表获取并删除右边最后一个元素，插入到destination左边第一个位置</span><br><span class="line">	//返回移动的那个元素值</span><br><span class="line">BLPop/BRPop key [key ...] timeout</span><br><span class="line">	//带阻塞式功能的LPop/RPop</span><br><span class="line">	//timeout为指定阻塞的最大秒数，为0时表示阻塞时间无限制</span><br><span class="line">	//列表中无元素可供获取，则发生阻塞。</span><br><span class="line">	//阻塞是所有列表中都无值时发生的。</span><br><span class="line">BRPopLPush source destination timeout</span><br><span class="line">	//带阻塞的RPopLPush</span><br><span class="line">	//返回移动的元素值，如果超时限，返回多批量的nil</span><br></pre></td></tr></table></figure>
<h4 id="集合命令"><a href="#集合命令" class="headerlink" title="集合命令"></a>集合命令</h4><p>集合元素无序且需唯一。</p>
<h5 id="基本集合操作命令"><a href="#基本集合操作命令" class="headerlink" title="基本集合操作命令"></a>基本集合操作命令</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">SAdd key member [member ...]</span><br><span class="line">	//集合中插入新元素，若member存在，则忽略</span><br><span class="line">	//返回添加成功的元素的数量</span><br><span class="line">SMembers key</span><br><span class="line">	//查看集合中的所有元素</span><br><span class="line">SRem key member [member ...]</span><br><span class="line">	//返回移除的值的个数</span><br><span class="line">	//若指定成员不在集合中，则忽略</span><br><span class="line">SCard key</span><br><span class="line">	//返回集合存储的元素的数量</span><br><span class="line">SRandMember key [count]</span><br><span class="line">	//count为该命令随机返回的参数的个数</span><br><span class="line">	//若count为负值，则返回count绝对值个成员，且成员可能会重复</span><br><span class="line">SMove source destination member</span><br><span class="line">	//将元素member从source中移出，添加到destination中</span><br><span class="line">SPop key [count]</span><br><span class="line">	//与SRandMember类似</span><br><span class="line">	//在返回元素的同时，也删除相应的元素</span><br><span class="line">SIsMember key member</span><br><span class="line">	//若元素member在集合中，则返回1，否则返回0</span><br><span class="line">SScan key cursor [MATCH pattern] [COUNT count]</span><br><span class="line">	//cursor为返回给客户端的集合读取游标；</span><br><span class="line">	//MATCH为读取指定模式的元素；</span><br><span class="line">	//COUNT指定读取元素的数量</span><br></pre></td></tr></table></figure>
<h5 id="集合交并差运算操作命令"><a href="#集合交并差运算操作命令" class="headerlink" title="集合交并差运算操作命令"></a>集合交并差运算操作命令</h5><p>分为两大类交并差操作运算，一种是不带存储的，即运算后直接返回运算结果；另一种是带存储的，即运算后的结果保存在一个新的集合中，返回运算结果中元素的数量。<br>并：<code>SUnion/SUnionStore key [key ...]</code><br>交：<code>SInter/SInterStore key [key ...]</code><br>差：<code>SDiff/SDiffStore key [key ...]</code> ，注意，多个集合差，是求第一个集合减去后续集合的结果。</p>
<h4 id="散列表命令"><a href="#散列表命令" class="headerlink" title="散列表命令"></a>散列表命令</h4><p>键值映射，无序。键唯一。</p>
<h5 id="基本散列表操作命令"><a href="#基本散列表操作命令" class="headerlink" title="基本散列表操作命令"></a>基本散列表操作命令</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Hset key field value</span><br><span class="line">	//key为散列表名称，field为键</span><br><span class="line">	//field存在时，对应的值被重写</span><br><span class="line">HGet key field</span><br><span class="line">	//获取指定的值</span><br><span class="line">HMSet key field value [field value ...]</span><br><span class="line">	//插入多个值</span><br><span class="line">HMGet key field [field ...]</span><br><span class="line">	//读取散列表的多个值</span><br><span class="line">HGetAll key</span><br><span class="line">	//返回指定散列表所有键值对的列表</span><br><span class="line">HExists key field</span><br><span class="line">	//指定的散列表的键存在，返回1，否则返回0</span><br><span class="line">HDel key field [field ...]</span><br><span class="line">	//返回删除的键值对数目</span><br></pre></td></tr></table></figure>
<h5 id="其他散列表操作命令"><a href="#其他散列表操作命令" class="headerlink" title="其他散列表操作命令"></a>其他散列表操作命令</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Hlen key</span><br><span class="line">	//返回散列表包含的键值对数目</span><br><span class="line">HSetNX key field value</span><br><span class="line">	//仅对散列表的新键设置值，旧键不重写</span><br><span class="line">HStrLen key field</span><br><span class="line">	//返回散列表指定的值的字符串字节长度</span><br><span class="line">HVals key</span><br><span class="line">	//返回指定散列表所有键值的列表</span><br><span class="line">	//只返回值</span><br><span class="line">HincrBy key field increment</span><br><span class="line">	//返回增量后该键的新值</span><br><span class="line">HincrByFloat key field increment</span><br><span class="line">	//对浮点数做加操作</span><br><span class="line">HKeys key</span><br><span class="line">	//返回指定但列表的所有键名列表</span><br><span class="line">HScan key cursor [MATCH pattern] [COUNT count]</span><br><span class="line">	//分批次返回指定复合条件的散列表里的键值对。</span><br><span class="line">	//注意，cursor从0开始，</span><br><span class="line">	//再次调用的时候，为前一次返回的数值</span><br></pre></td></tr></table></figure>
<p>所有sacn类型的操作都类似，下图以scan为例：<br><img src="https://upload-images.jianshu.io/upload_images/12985001-6b62fac8c0b5350d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="scan示例"></p>
<h4 id="有序集合命令"><a href="#有序集合命令" class="headerlink" title="有序集合命令"></a>有序集合命令</h4><p>有序集合与散列表存储结构类似，都采用一对一映射关系的键值对实现对数据的管理。<br>有序集合的键所对应的值只能是浮点数，这种值又叫Score，默认对该值由低到高进行排序。<br>对于值相同的成员，则对键按照二进制数据排序。</p>
<h5 id="基本的有序集合操作命令"><a href="#基本的有序集合操作命令" class="headerlink" title="基本的有序集合操作命令"></a>基本的有序集合操作命令</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ZAdd key [NX|XX] [CH] [INCR] score member [score member ...]</span><br><span class="line">	//NX只添加不更新，XX仅更新不添加</span><br><span class="line">	//CH返回所有值被修改的键值对总数(包含新增键值对)</span><br><span class="line">	//[INCR]对指定的member进行加score操作</span><br><span class="line">	//默认返回新增加的键值对数量</span><br><span class="line">ZRange key start stop [WITHSCORES]</span><br><span class="line">	//返回指定位置的键/键值对</span><br><span class="line">	//WITHSCORES指定为返回键值对</span><br><span class="line">ZCount key min max</span><br><span class="line">	//统计在min和max之间的元素数量，默认闭区间</span><br><span class="line">	//在min或max前加“(&quot;，表示开区间</span><br></pre></td></tr></table></figure>
<p>Zcount示例：<br><img src="https://upload-images.jianshu.io/upload_images/12985001-d9ac80a747724a0c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ZCount示例"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">ZRem key member [member ...]</span><br><span class="line">	//返回删除的键值对个数</span><br><span class="line">ZCard key</span><br><span class="line">	//返回有序集合的键值对个数</span><br><span class="line">ZIncrBy key increment member</span><br><span class="line">	//增量可以为整数也可以为浮点数</span><br><span class="line">ZLexCount key min max</span><br><span class="line">	//返回指定键范围的个数</span><br><span class="line">	//min或max前加必须加“[”或“(”表示闭开区间；</span><br><span class="line">	//“+”，“-”号代表min和max，表示统计所有键值对</span><br><span class="line">ZScore key member</span><br><span class="line">	//返回key指向的有序集合中成员member的值</span><br><span class="line">ZRank key member</span><br><span class="line">	//返回member在集合中的排名</span><br></pre></td></tr></table></figure></p>
<h5 id="其他有序集合操作命令"><a href="#其他有序集合操作命令" class="headerlink" title="其他有序集合操作命令"></a>其他有序集合操作命令</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">ZUnionStore destination numkeys key [key ...] [WEIGHTS weight] [SUM|MIN|MAX]</span><br><span class="line">	//numkey为参与运算的有序集合的个数</span><br><span class="line">	//WEIGHTS为每个key指定一个乘法因子，聚合前，每个key里参与运算的score先跟该因子相乘</span><br><span class="line">	//SUM，对相同键值的成员相加；</span><br><span class="line">	//MIN/MAX，对相同键值的成员取最小(大)值</span><br><span class="line">	//返回destination中成员个数</span><br><span class="line">ZInterStore destination numkeys key [key ...] [WEIGHTS weigth ...] [SUM|MIN|MAX]</span><br><span class="line">	//同上，只是求交集</span><br><span class="line">ZRemRangeByLex key min max</span><br><span class="line">	//删除指定键范围内的成员</span><br><span class="line">	//min和max的要求和ZLexCount命令类似</span><br><span class="line">	//注意，这里删除的集合的成员，其score必须相同</span><br><span class="line">ZRangeByLex key min max [LIMIT offset count]</span><br><span class="line">	//这里LIMIT参数，表示分页，其中offset为分页开始的元素，count为显示的元素数量</span><br><span class="line">	//注意，这里的score也都必须相同</span><br><span class="line">ZRangeByScore key min max [WITHSCORES] [LIMIT offset count]</span><br><span class="line">	//这里的min和max为score的限定界限，可以加“(”来表示为开区间，使用+inf和-inf表示无穷小和无穷大</span><br><span class="line">	//这里的score不必都相等</span><br><span class="line">ZRemRangeByScore key min max</span><br><span class="line">	//min和max与上相同</span><br><span class="line">	//返回删除键值对个数</span><br><span class="line">ZRemRangeByRank key start stop</span><br><span class="line">	//这里start和stop是排序后的下标范围，可正可负</span><br><span class="line">	//返回删除的键值对的个数</span><br><span class="line">ZRevRange key start stop [WITHSCORES]</span><br><span class="line">	//返回指定分值下标范围的键或键值对列表</span><br><span class="line">	//ZRevRange和ZRange区别是返回结果的排列顺序</span><br><span class="line">ZRevRangeByLex key max min [LIMIT offset count]</span><br><span class="line">	//max min是下标范围，必须使用“[”&quot;(&quot;,或“+”“-”</span><br><span class="line">	//LIMIT分页显示，Score必须相同</span><br><span class="line">	//反向输出</span><br><span class="line">ZRevRangeByScore key max min [WITHSCORES] [LIMIT offset count]</span><br><span class="line">	//和ZRangeByScore类似，只是方向相反</span><br><span class="line">ZRevRank key member</span><br><span class="line">	//返回指定成员在集合中的倒序排名</span><br><span class="line">ZScan cursor [MATCH pattern] [COUNT count]</span><br><span class="line">	//Scan类操作，分批返回游标指定的有序集合中的内容</span><br></pre></td></tr></table></figure>
<h4 id="发布订阅命令"><a href="#发布订阅命令" class="headerlink" title="发布订阅命令"></a>发布订阅命令</h4><p>发布订阅模式中，发布者可以对多个频道发布信息，订阅者可以从自己订阅的一个或多个频道来接受信息。<br>这种模式适用于即时通信应用。<br>注意：Publish和Subscribe命令是基于内存运行的，客户端下线后，就无法接受消息，造成部分消息丢失。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">Publish channel message</span><br><span class="line">	//channel为建立的频道名，也可以把它看作键名</span><br><span class="line">	//message为需要发送的信息，可以看作值；</span><br><span class="line">	//返回收到消息的客户端数量</span><br><span class="line">Subscribe channel [channel ...]</span><br><span class="line">	//channel为指定的获取消息的频道名</span><br><span class="line">	//返回指定频道的消息列表</span><br><span class="line">PSubscribe pattern [pattern ...]</span><br><span class="line">	//pattern为指定的订阅模式，允许多模式指定</span><br><span class="line">	//返回的消息为指定模式的消息</span><br><span class="line">PunSubscribe [pattern [pattern ...]]</span><br><span class="line">	//取消指定的订阅模式</span><br><span class="line">	//若未指定订阅模式，则取消所有订阅模式</span><br><span class="line">	//返回取消模式的消息列表</span><br><span class="line">UnSubscribe [channel [channel ...]]</span><br><span class="line">	//退订指定的频道</span><br><span class="line">	//返回取消消息列表</span><br><span class="line">PubSub subcommand [argument [argument ...]]</span><br><span class="line">	//PubSub为服务器端发送订阅信息的统计</span><br><span class="line">	//subcommand 可以是</span><br><span class="line">	Channels [pattern]</span><br><span class="line">		//列出当前活动的频道，有pattern时，只列出和模式匹配的频道</span><br><span class="line">	NumbSub [channel, ...]</span><br><span class="line">		//列出对应频道的订阅量</span><br><span class="line">	NumPat</span><br><span class="line">		//官网啥意思啊：https://redis.io/commands/pubsub</span><br></pre></td></tr></table></figure></p>
<h4 id="连接命令"><a href="#连接命令" class="headerlink" title="连接命令"></a>连接命令</h4><p>连接服务器端redis数据库的基本操作命令如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Auth password</span><br><span class="line">	//数据库管理员在/etc/redis.conf的配置文件的#requirepass foobared参数选项上设置了密码，则客户端登陆时需要Auth命令验证密码</span><br><span class="line">	//验证成功返回OK</span><br><span class="line">Echo message</span><br><span class="line">	//在客户端输出message字符串</span><br><span class="line">Ping [字符串]</span><br><span class="line">	//无参数时，返回PONG</span><br><span class="line">	//带参数时返回“PONG 字符串”</span><br><span class="line">Quit</span><br><span class="line">	//请求服务器关闭跟客户端的连接</span><br><span class="line">	//链接关闭前，会将客户端请求处理完</span><br><span class="line">Select index</span><br><span class="line">	//index为跟服务器端Redis数据库连接下标值</span><br><span class="line">	//从0开始，默认是0</span><br><span class="line">	//相当于切换命名空间，集群不可用</span><br></pre></td></tr></table></figure></p>
<h4 id="Server操作命令"><a href="#Server操作命令" class="headerlink" title="Server操作命令"></a>Server操作命令</h4><p>实现对数据库的各种管理，包括与客户端连接相关、获取Redis相关信息的命令，与Redis配置文件相关的命令，与磁盘操作相关的命令及对数据库进行测试、调试等相关命令。</p>
<h5 id="与客户端连接、获取命令信息相关的命令"><a href="#与客户端连接、获取命令信息相关的命令" class="headerlink" title="与客户端连接、获取命令信息相关的命令"></a>与客户端连接、获取命令信息相关的命令</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Client List</span><br><span class="line">	//获取客户端连接信息及连接数量</span><br></pre></td></tr></table></figure>
<p><img src="https://upload-images.jianshu.io/upload_images/12985001-1f8f457f93ff658b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Client List命令"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Client SetName name</span><br><span class="line">	//设置连接名</span><br><span class="line">Client GetName</span><br><span class="line">	//返回连接名</span><br><span class="line">Client Kill [ip:port] [ID client-id] [TYPE normal|master|slave|pubsub] [ADDR ip:port] [SKIPME yes/no]</span><br><span class="line">	//关闭客户端连接</span><br><span class="line">	//ip:port为指定的客户端IP地址和端口号</span><br><span class="line">	//TYPE为normal、master、slave、pubsub指定一种特殊类型的客户端</span><br><span class="line">	//SKIPME,是否关闭当前客户端连接</span><br><span class="line">	//指定IP时若关闭成功返回OK；使用TYPE参数时，返回被关闭的客户端数量</span><br><span class="line">	//该命令允许多条件限制</span><br><span class="line">Client Pause timeout</span><br><span class="line">	//暂停处理客户端命令</span><br><span class="line">	//timeout 以毫秒为单位的时间</span><br><span class="line">Command </span><br><span class="line">	//返回Redis所有命令详细信息</span><br><span class="line">Command count</span><br><span class="line">	//返回Redis命令的总统计数</span><br><span class="line">Command GetKeys</span><br><span class="line">	//返回指定命令的所有键</span><br><span class="line">	例子：command GetKeys mset a b c d e f</span><br><span class="line">		//返回mset...命令中的键</span><br><span class="line">Command Info command-name [command-name ...]</span><br><span class="line">	//command-name为Redis里的任意命令名</span><br><span class="line">	//返回指定命令的详细信息</span><br></pre></td></tr></table></figure></p>
<h5 id="与配置文件、磁盘操作相关的命令"><a href="#与配置文件、磁盘操作相关的命令" class="headerlink" title="与配置文件、磁盘操作相关的命令"></a>与配置文件、磁盘操作相关的命令</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Config Get parameter</span><br><span class="line">	//parameter为redis配置文件里的参数名</span><br><span class="line">	//参数名里可以用“*”匹配符号</span><br><span class="line">	//部分redis.conf文件里的参数不支持该命令的读取</span><br><span class="line">Config ResetStat</span><br><span class="line">	//复位INFO命令中的统计报告</span><br><span class="line">	//总是返回OK</span><br><span class="line">Config Set parameter value</span><br><span class="line">	//设置配置文件指定参数的值</span><br><span class="line">	//Config Get可以获得的命令，都可以用该命令设置</span><br><span class="line">	//设置成功后从下一个命令开始使用新配置</span><br><span class="line">Config ReWrite</span><br><span class="line">	//重写内存中的配置文件到磁盘</span><br><span class="line">BGRewriter Aof</span><br><span class="line">	//异步重写Aof(AppendOnly File)操作</span><br><span class="line">	//重写会创建一个当前AOF文件的体积优化版本</span><br><span class="line">	//Redis2.4开始，其自动重写，而该命令仅仅用于手动触发重写程序</span><br><span class="line">BGSave</span><br><span class="line">	//异步保存数据集到磁盘上</span><br><span class="line">LastSave</span><br><span class="line">	//获得最后一次同步磁盘的时间</span><br><span class="line">Save</span><br><span class="line">	//同步数据到磁盘上</span><br><span class="line">	//该命令会阻塞所有客户端的请求</span><br><span class="line">	//一般，只有BGSave执行失败后才使用该命令</span><br></pre></td></tr></table></figure>
<h5 id="Server操作的其他命令"><a href="#Server操作的其他命令" class="headerlink" title="Server操作的其他命令"></a>Server操作的其他命令</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">DBSize</span><br><span class="line">	//返回当前数据库实例中存储对象的个数</span><br><span class="line">Debug Object key</span><br><span class="line">	//数据存储对象调试命令</span><br><span class="line">Debug Segfault</span><br><span class="line">	//让redis崩溃</span><br><span class="line">FlushAll [ASYNC]</span><br><span class="line">	//删除所有数据库里的所有数据</span><br><span class="line">	//建议在配置文件里禁用该命令</span><br><span class="line">	//添加可选项，使用多线程异步删除数据库功能</span><br><span class="line">FlushDB [ASYNC]</span><br><span class="line">	//删除当前数据库的所有数据</span><br><span class="line">	//其他情况与上命令类似</span><br><span class="line">Info [section]</span><br><span class="line">	//返回redis服务器的各种信息和统计数据</span><br><span class="line">	//可选参数section，则只返回指定部分</span><br><span class="line">	//section的值可以是：</span><br><span class="line">		//server:服务器一般信息；client：客户端连接部分；</span><br><span class="line">		//memory：内存消耗相关信息；persistence：RDB和AOF相关信息</span><br><span class="line">		//stats：一般统计；replication：主从复制信息</span><br><span class="line">		//cpu：CPU消耗统计；commandstats：Redis命令统计信息</span><br><span class="line">		// cluster：Redis集群信息；keyspace：数据库相关统计</span><br><span class="line">		//all：所有信息；default：只返回默认设置的信息</span><br><span class="line">Monitor</span><br><span class="line">	//持续返回服务器端处理的每一个命令信息</span><br><span class="line">	//ctrl+c终止执行</span><br><span class="line">Role</span><br><span class="line">	//返回主从实例所属的角色</span><br><span class="line">ShutDown [NOSAVE][SAVE]</span><br><span class="line">	//异步保存数据到磁盘</span><br><span class="line">	//NOSAVE被指定时，不保存数据到磁盘</span><br><span class="line">	//SAVE被指定时，强制保存数据到磁盘</span><br><span class="line">SlaveOf host port</span><br><span class="line">	//host为指定服务器的IP地址，port为指定服务器的端口号</span><br><span class="line">	//将当前服务器设置为指定服务器的从属服务器</span><br><span class="line">	//若当前服务器已经是某个主服务器的从属服务器，将丢弃旧数据集，转而同步新主服务器数据</span><br><span class="line">SlaveOf No one</span><br><span class="line">	//从属服务器恢复主服务器状态</span><br><span class="line">	//原来同步的数据不会被丢弃</span><br><span class="line">SlowLog subcommand [argument]</span><br><span class="line">	//管理Redis的慢速记录日志</span><br><span class="line">	//subcommand为指定的操作慢速记录日志的子命令</span><br><span class="line">	//可以是Get，通过argument返回指定的数量的慢操作日志；</span><br><span class="line">	//Len，返回日志的总长度</span><br><span class="line">	//Reset，重置慢速记录日志的慢速命令记录</span><br><span class="line">		//注意：Redis.conf配置文件中，可以修改slowlog-log-slow-than参数，指定慢日志记录的时限，单位是微秒</span><br><span class="line">		//slowLog-max-len配置慢日志保存的条数</span><br><span class="line">SYNC</span><br><span class="line">	//用于同步主从服务器</span><br><span class="line">Time</span><br><span class="line">	//返回两个字符串的列表，第一个表示服务器当前UNIX时间戳，第二个表示最近一秒已经过去的微秒数</span><br></pre></td></tr></table></figure>
<p><a href="https://redis.io/commands/info" target="_blank" rel="noopener">INFO命令返回内容详解：</a></p>
<h4 id="脚本命令"><a href="#脚本命令" class="headerlink" title="脚本命令"></a>脚本命令</h4><p>Redis中的Lua脚本语言，提供了在Redis服务器端连续执行代码的功能。具体命令如下<br><a href="https://www.lua.org/" target="_blank" rel="noopener">LUA脚本语言官网地址</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">EVal script numkey key [key ...] arg [arg ...]</span><br><span class="line">	//执行Lua脚本命令</span><br><span class="line">	//script为Lua脚本，key表示Lua脚本用到的键</span><br><span class="line">	//键名可以通过全局变量KEYS数组在Lua脚本中使用</span><br><span class="line">	//其基地址为KEYS[1]</span><br><span class="line">	//可选参数arg可以通过全局变量ARGV数组访问</span><br><span class="line">	//返回该Lua脚本运行结果</span><br><span class="line">Script Load script</span><br><span class="line">	//script为指定的Lua脚本</span><br><span class="line">	//返回给定脚本的SHA1校验和</span><br><span class="line">	//该命令只将Lua脚本添加到服务器端脚本缓存中，而不执行它</span><br><span class="line">EValSha sha1 numkeys key [key ...] arg[arg ...]</span><br><span class="line">	//这里的sha1位存储在服务器缓存中的脚本Sha1校验码，由Script Load脚本命令生成</span><br><span class="line">Script Flush</span><br><span class="line">	//清空当前连接的服务器端缓存的所有Lua脚本</span><br><span class="line">Script Exists script [script ...]</span><br><span class="line">	//参数script为带检查的脚本的Sha1校验码</span><br><span class="line">	//脚本存储返回1，不存在返回0</span><br><span class="line">Script Kill</span><br><span class="line">	//终止当前服务器端正在运行的Lua脚本</span><br><span class="line">	//当且仅当这个脚本没有执行任何写操作，该命令才生效</span><br></pre></td></tr></table></figure></p>
<h4 id="键命令"><a href="#键命令" class="headerlink" title="键命令"></a>键命令</h4><p>这里的键命令，是只操作存储在数据库里的各种数据存储对象。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">Del key [key ...]</span><br><span class="line">	//删除键对应的数据对象</span><br><span class="line">Dump key</span><br><span class="line">	//序列化给定的数据对象。</span><br><span class="line">	//与反序列化配合使用</span><br><span class="line">Exists key [key ...]</span><br><span class="line">	//key存在则返回1，否则返回0</span><br><span class="line">Expire key seconds</span><br><span class="line">	//seconds为指定的过时时间，单位秒</span><br><span class="line">	//超过指定的时间后，该key被自动删除</span><br><span class="line">ExpireAt key timestamp</span><br><span class="line">	//timestamp为指定的Unix时间戳，单位秒</span><br><span class="line">	//设置key的过期时间</span><br><span class="line">Keys pattern</span><br><span class="line">	//查找所有符合模式的key</span><br><span class="line">	//pattern的通配符号，?单个字符，*多个字符，[abc]任意一个，[^a]非a，[a-c]abc中的任何一个</span><br><span class="line">Migrate host port key destination-db timeout [COPY][REPLACE]</span><br><span class="line">	//原子性的把当前Key转移到指定数据库中(可以跨服务器)</span><br><span class="line">	//destination-db为目标服务器名</span><br><span class="line">	//COPY保留当前数据库的key</span><br><span class="line">	//REPLACE为替换目标数据实例上已经存在的key</span><br><span class="line">	//注意：若返回出错，可能key出现在两个数据库中，也可能只在当前数据库中</span><br><span class="line">Move key db</span><br><span class="line">	//将当前数据库的key转移到指定数据库</span><br><span class="line">	//db为数据库编号</span><br><span class="line">	//注意若key在两个数据库都存在或不存在于当前数据库，则该命令什么也不做</span><br><span class="line">Object subcommand [arguments [argument ...]]</span><br><span class="line">	//以内部调试方式给出给出key的内部对象信息</span><br><span class="line">	//subcommand包括了</span><br><span class="line">		//RefCount key,返回指定的key所对应的Value被引用次数；</span><br><span class="line">		//Encoding key,返回....使用的内部压缩方式</span><br><span class="line">		//IdleTime key,返回指定key对应Value被存储之后的空闲时间，单位秒。调用set或get后重置</span><br><span class="line">	//内部压缩编码方式：字符串，raw或int；列表，ziplist或linkedlist；</span><br><span class="line">	//集合，intset或hashtable；散列表：zipmap或hashtable</span><br><span class="line">	//有序集合，ziplist或skiplist</span><br><span class="line">Persist key</span><br><span class="line">	//移除key指向的对象上设置的过期时间</span><br><span class="line">PExpire key milliseconds</span><br><span class="line">	//设置key的过期时间，毫秒</span><br><span class="line">PExpireAt key milliseconds-timestamp</span><br><span class="line">	//设置key的过期时刻，用Unix时间戳，单位毫秒</span><br><span class="line">PTTL key</span><br><span class="line">	//以毫秒为单位返回key的剩余生存时间</span><br><span class="line">	//key不存在，返回-2，key存在，但未设置生存时间返回-1</span><br><span class="line">RandomKey</span><br><span class="line">	//数据库没有key，返回nil</span><br><span class="line">	//否则返回一个随机的key</span><br><span class="line">Rename key newkey</span><br><span class="line">	//将指定的key重新命名</span><br><span class="line">RenameNX key newkey</span><br><span class="line">	//指定的newkey不存在时，才能修改key的名称</span><br><span class="line">Restore key ttl seralized-value [REPLACE]</span><br><span class="line">	//ttl为key指定的过时时间，ttl=0为不设置过期时间</span><br><span class="line">	//seralized-value为序列化值</span><br><span class="line">	//将值反序列化到key上，若key已经存在则返回错误，使用REPLACE时例外</span><br><span class="line">	//反序列化之前会验证数据的校验和，若RDB版本不相同或数据不完整，反序列化会被拒绝</span><br><span class="line">Scan cursor [MATCH pattern] [COUNT count]</span><br><span class="line">	//返回包含两个元素的数据，一个时下一次迭代的新游标，另一个时数据元素数组。</span><br><span class="line">Sort key [BY pattern] [LIMIT offset count] [GET pattern] [ASC|DESC] [ALPHA] [STORE destination]</span><br><span class="line">	//key为要排序的列表、集合或有序集合对象名，默认为升序ASC</span><br><span class="line">	//LIMIT表示要对排序结果返回哪部分数据</span><br><span class="line">	//BY pattern，根据其他模式对象的值来排序key的对象元素。需要一一对应</span><br><span class="line">	//Get Pattern根据对key的排序结果，返回对应的pattern中对象的值。</span><br><span class="line">	//ALPHA实现二进制值(ASCII)比较排序</span><br><span class="line">TTL key</span><br><span class="line">	//返回剩余生存时间，单位为秒</span><br><span class="line">Type key</span><br><span class="line">	//返回对应的数据结构类型(string,list,set,hash,zset)</span><br><span class="line">Wait numslaves timeout</span><br><span class="line">	//numslaves为需要阻塞的从服务器</span><br><span class="line">	//阻塞当前客户端，知道所有执行该命令之前的写命令成功地传输到指定的slaves</span><br><span class="line">	//timeout超时时间限制</span><br></pre></td></tr></table></figure></p>
<h4 id="HyperLogLog命令"><a href="#HyperLogLog命令" class="headerlink" title="HyperLogLog命令"></a>HyperLogLog命令</h4><p>HyperLogLog是一种概率数据解构，被用于统计唯一事务的基数。<br>该命令存在可容忍范围内的一定的偏差。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PFAdd key element [element ...]</span><br><span class="line">	//将指定的元素添加到指定的HyperLogLog中</span><br><span class="line">PFCount key [key ...]</span><br><span class="line">	//当一个key时，返回近似基数</span><br><span class="line">	//当多个key时，返回这些key指定的HyperLogLog结构元素进行并后的运算结果。</span><br><span class="line">PFMerge destkey sourcekey [sourcekey ...]</span><br><span class="line">	//将多个HyperLogLog合并，存储在destkey中</span><br><span class="line">	//返回OK</span><br></pre></td></tr></table></figure></p>
<h4 id="地理空间命令"><a href="#地理空间命令" class="headerlink" title="地理空间命令"></a>地理空间命令</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">GEOAdd key longitude latitude member [longitude latitude member ...]</span><br><span class="line">	//key为地理空间数据对象(一个有序集合，存储了地理空间位置内容,经度、纬度、名称)</span><br><span class="line">	//返回添加元素的个数，不包括更新的元素</span><br><span class="line">GEODist key member1 member2 [uint]</span><br><span class="line">	//unit是返回位置之间距离的单位，m,km,mi(英里),ft(英尺)。默认为m</span><br><span class="line">GEOHash key member [member ...]</span><br><span class="line">	//返回一个数组，数组内容是对应位置的GEOHash</span><br><span class="line">GEOPos key member [member ...]</span><br><span class="line">	//返回指定位置的经纬度</span><br><span class="line">GEORadius key longitude latitude radius m|km|ft|mi [WITHCOORD] [WITHDIST] [WITHHASH] [COUNT count]</span><br><span class="line">	//查询指定范围内的所有空间地理元素的集合</span><br><span class="line">	//radius为指定的半径距离数，单位可选</span><br><span class="line">	//WITHDIST,在返回位置元素的同时，将位置元素与中心之间的距离一并返回</span><br><span class="line">	//WITHCOORD将位置元素的经纬度也一并返回</span><br><span class="line">	//WITHHASH，返回位置元素经过原始GEOHash编码的有序集合score</span><br><span class="line">	//COUNT，返回前count个匹配位置</span><br><span class="line">GEORadiusByMember key member radius m|km|ft|mi [WITHCOORD] [WITHDIST] [WITHHASH] [COUNT count]</span><br><span class="line">	//与上一条命令唯一区别是其中心点由member指定</span><br></pre></td></tr></table></figure>
<h4 id="事务命令"><a href="#事务命令" class="headerlink" title="事务命令"></a>事务命令</h4><p>事务命令实现与关系型数据库所提供的事务功能类似。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Multi</span><br><span class="line">	//标记一个事务块的开始</span><br><span class="line">Exec</span><br><span class="line">	//执行事务块</span><br><span class="line">	//若事务块内的所有命令都被执行，返回被执行命令的结果。否则返回nil</span><br><span class="line">Discard</span><br><span class="line">	//放弃执行事务块内的所有命令。</span><br><span class="line">Watch key [key ...]</span><br><span class="line">	//监视一个(或多个)key，如果在事务执行之前这个(或这些)key被其他命令改动，那么事务将被打断。</span><br><span class="line">	//该命令配合Multi、Exec命令使用</span><br><span class="line">	//Exec执行后，Watch作用自动取消。</span><br><span class="line">UnWatch</span><br><span class="line">	//取消Watch命令对所有key的监视</span><br></pre></td></tr></table></figure></p>
<h4 id="集群命令"><a href="#集群命令" class="headerlink" title="集群命令"></a>集群命令</h4><p>Redis集群的概念，首先是指多服务器的物理部署，另外也指向配套的Redis数据库软件支持功能，主要是集群相关的各种操作命令及部署内容。<br>Redis物理部署，要遵从主存复制部署原理的要求，也遵循分片原理的要求。</p>
<h4 id="Redis数据库软件功能"><a href="#Redis数据库软件功能" class="headerlink" title="Redis数据库软件功能"></a>Redis数据库软件功能</h4><p>数据分片、主从赋值、哨兵(Sentinel)技术、分布式读写分离。<br>Redis集群不支持处理多key对象的命令。<br>Redis不能保证数据的强一致性。<br>Redis集群不支持事务操作；集群只有0号数据库，不支持select命令。<br>Redis横向服务器扩展可支持到1000个。</p>
<h4 id="集群命令相关的术语"><a href="#集群命令相关的术语" class="headerlink" title="集群命令相关的术语"></a>集群命令相关的术语</h4><ol>
<li>Hash Slots(哈希插槽)，通过Hash算法，用来解决Redis分布式数据存储指定问题(Redis数据分片)。<br>Redis为集群提供16384个哈希插槽。key对应插槽的计算方法Slot=CRC16(key)mod16384</li>
<li>节点，指服务器上装着的一个Redis数据库系统。</li>
<li>Gossip，Redis的节点之间的通信协议。Redis为集群操作的消息通信单独开辟了一个TCP通道，交换二进制信息。<br>Ping/Pong：Redis集群的心跳，每个节点每秒随机Ping几个节点。节点的选择方法是，一半的时间还未ping过或收到pong的节点。心跳除了包含节点自己的数据外，还包括其他节点的数据。<br>Meet/Pong：只有meet后的受信节点才能加入到Ping/Pong通信中。<br>节点根据Ping和Pong消息节点会把自己的详细信息以及已经和字节完成握手的三个节点的地址发给对方。详细信息包括Epoch，收到信息的节点会根据自己的Epoch和收到的Epoch来决定更新数据或通知对方更新数据。<h4 id="集群相关的操作命令"><a href="#集群相关的操作命令" class="headerlink" title="集群相关的操作命令"></a>集群相关的操作命令</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">Cluster Info</span><br><span class="line">	//以键值对形式返回所有集群相关的命令信息。</span><br><span class="line">Cluster Meet ip port</span><br><span class="line">	//实现集群节点之间的通信</span><br><span class="line">	//这里的每个服务器都需要完成配置，且他们之间没有建立通信联系</span><br><span class="line">Cluster Replicate node-id</span><br><span class="line">	//将node-id服务器修改为Slave节点</span><br><span class="line">Cluster Nodes</span><br><span class="line">	//返回集群节点配置详细信息</span><br><span class="line">Cluster Forget node-id</span><br><span class="line">	//节点移除成功，返回OK</span><br><span class="line">	//实质上，该移除操作是在节点自带的节点列表上禁用移除的节点。</span><br><span class="line">	//移除条件：</span><br><span class="line">		//①把指定节点插槽转移，确保移除的节点是空节点</span><br><span class="line">		//②要在与该节点产生关系的其他节点，执行该命令</span><br><span class="line">		//③挨个节点移除，每个执行完该命令的节点有一分钟的禁止时间。</span><br><span class="line">		//④不能在当前节点上执行移除自己的操作</span><br><span class="line">Cluster Reset [HARD|SOFT]</span><br><span class="line">	//重新设置集群节点</span><br><span class="line">	//HARD,强制重新设置节点的ID号，并设置配置文件里的各个Epoch为0，对Redis保存到磁盘上的配置文件内容进行持久性更新；</span><br><span class="line">	//SOFT,不更新磁盘上的上述内容，该命令是默认选项。</span><br><span class="line">	//被重置的节点上不能有数据对象；</span><br><span class="line">	//执行该命令的节点是一个Slave节点，则该节点将变成一个空的主节点。</span><br><span class="line">Cluster SaveConfig</span><br><span class="line">	//把运行在内存中的节点配置信息，强制保存到磁盘的Nodes.conf中，若操作成功则返回OK。</span><br><span class="line">Cluster Set-Config-Epoch config-epoch</span><br><span class="line">	//config-epoch为当前节点指定的最新配置时间标志(整数),不同节点要求唯一。</span><br><span class="line">	//该命令适用情况：</span><br><span class="line">		//①节点的节点表为空，即刚刚安装Redis数据库，还没有进行配置；</span><br><span class="line">		//②当前节点配置时限为0；</span><br><span class="line">Cluster Slaves node-id</span><br><span class="line">	//node-id为指定的主节点号</span><br><span class="line">	//返回主节点的从节点的列表信息</span><br><span class="line">Cluster Count-Failure-Reports node-id</span><br><span class="line">	//返回指定节点的故障报告数</span><br><span class="line">Cluster FailOver [FORCE][TAKEOVER]</span><br><span class="line">	//手动将该从节点启动为主节点</span><br><span class="line">	//常用于对无故障的主节点的升级操作</span><br><span class="line">	//FORCE,从节点不会与对应的主节点握手，这可能导致从节点无法访问对应的主节点；</span><br><span class="line">	//TAKEOVER,实现从节点故障转移操作时，不与其他节点进行联系。慎用</span><br><span class="line">ReadOnly</span><br><span class="line">	//Redis集群中，Slave服务不为客户端提供读服务，可以通过该命令来允许客户端直接读指定的Slave服务器数据库。</span><br><span class="line">ReadWrite</span><br><span class="line">	//禁止读请求跳转到集群的从节点上</span><br><span class="line">Cluster AddSlots slot [slot ...]</span><br><span class="line">	//为某节点服务数据库增加插槽</span><br><span class="line">	//若某节点的配置文件里已经存在importing设置值，该命令执行成功会将改配置值清除</span><br><span class="line">Cluster SetSlot slot IMPORTING|MIGRATING|STABLE|NODE [node-id]</span><br><span class="line">	//slot为指定的插槽序号值，node-id为目标节点ID号。</span><br><span class="line">	//四个参数指定插槽在不同的节点之间的迁移方式</span><br><span class="line">	//IMPORTING，从node-id中导入插槽到当前节点，并把当前节点配置文件里的插槽参数设置为导入状态。</span><br><span class="line">	//MIGRANTING,将本节点的插槽迁移到node-id，并把当前节点设置为迁移状态</span><br><span class="line">	//STABLE,取消当前节点对插槽的导入或迁移状态设置</span><br><span class="line">	//NODE，将插槽Slot迁移到node-id指定的节点，如果该插槽已经迁移到另一个节点，那么先让里一个节点删除该插槽，再进行迁移</span><br><span class="line">	//注意：该命令值迁移插槽序号，不迁移数据</span><br><span class="line">Cluster GetKeysSinSlot slot count</span><br><span class="line">	//slot为当前主节点指定插槽序号，count为将要返回的插槽里的key对象的列表。</span><br><span class="line">Cluster DelSlots slot [slot ...]</span><br><span class="line">	//slot为当前主节点上的指定的插槽序号</span><br><span class="line">	//删除成功返回ok</span><br><span class="line">	//注意：该命令执行成功后会删除对应插槽内的Keys数据</span><br><span class="line">Cluster Slots</span><br><span class="line">	//返回带IP/port映射的插槽范围列表</span><br><span class="line">Cluster KeySlot key</span><br><span class="line">	//返回key产生的哈希插槽序列号</span><br><span class="line">Cluster CountKeySinSlot slot</span><br><span class="line">	//slot为当前节点的指定插槽的序列号</span><br><span class="line">	//返回指定插槽下的Keys的数量。</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="Redis配置及参数"><a href="#Redis配置及参数" class="headerlink" title="Redis配置及参数"></a>Redis配置及参数</h3><p>Redis默认配置下已经可以很好的运行了，但是为了提高数据库效率、安全等，可以对其进行相关的配置操作。</p>
<h4 id="Config配置文件"><a href="#Config配置文件" class="headerlink" title="Config配置文件"></a>Config配置文件</h4><p>配置文件名为Redis.conf，存放在Redis数据库系统的安装目录下。<br>Redis.conf中的参数以参数名+参数值的形式存在，允许出现多值，中间用空格隔开。<br>Redis服务安装好，启动时，需要用<code>./redis-server redis.conf</code>的格式启动，否则Redis使用默认的内存配置文件，在磁盘上找不到对应的配置文件。</p>
<p>#####设置Redis.conf文件参数有以下集中形式：</p>
<ol>
<li>启动Redis服务器，带参数设置，该方法适合技术人员的测试使用；<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./redis-server -slaveof 127.0.0.1 8000</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>该方式直接影响内存上的配置文件项，如果Redis开了持久性，一段时间后，会自动刷新磁盘上的配置文件，若中途断电等，则会丢失配置内容。</p>
<ol start="2">
<li>在Redis服务运行期间，通过配置命令，更改参数设置；<br>如：Cluster Meet、Cluster FailOver等可以影响配置，也可以使用Config set和Config get来实现内部参数设置。</li>
<li>把Redis配置成为一个缓存；<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Config Set maxmemory 2mb </span><br><span class="line">	//最大内存使用量为2mb</span><br><span class="line">config Set maxmemory-policy allkeys-lru</span><br><span class="line">	//Redis使用的空间达到最大值时，自动使用LRU算法删除某些不常用的Key对象。</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="配置文件参数"><a href="#配置文件参数" class="headerlink" title="配置文件参数"></a>配置文件参数</h4><p>常用的配置参数、快照配置参数、复制配置参数、安全配置参数、限制配置参数、AOF持久化配置策略、Lua脚本配置参数、集群配置参数、慢命令记录日志配置参数、延迟监控配置参数、数据集事件通知配置参数、高级配置参数。<br><a href="https://cloud.tencent.com/developer/article/1097636" target="_blank" rel="noopener">配置文件详解</a></p>
<h3 id="Java连接Redis"><a href="#Java连接Redis" class="headerlink" title="Java连接Redis"></a>Java连接Redis</h3><p>步骤：</p>
<ol>
<li>安装Redis数据库系统；</li>
<li>安装Java开发环境；</li>
<li>下载jedis.jar安装包，安装Java驱动程序；</li>
<li>创建Java项目，连接redis数据库。<br>配置文件<code>redis-config.properties</code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ip=127.0.0.1:6379</span><br><span class="line">maxActive=1000</span><br><span class="line">maxIdle=100</span><br><span class="line">maxWait=10000</span><br><span class="line">testOnBorrow=false</span><br><span class="line">timeout=2000</span><br><span class="line">cluster.ip=127.0.0.1:6379</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>Java连接Redis代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStream;</span><br><span class="line">import java.util.Properties;</span><br><span class="line"></span><br><span class="line">import redis.clients.jedis.JedisPool;</span><br><span class="line">import redis.clients.jedis.JedisPoolConfig;</span><br><span class="line">import redis.clients.jedis.util.RedisInputStream;</span><br><span class="line"></span><br><span class="line">public class conredis &#123;</span><br><span class="line">	public static JedisPool initPool() throws IOException&#123;</span><br><span class="line">		InputStream inputStream = RedisInputStream.class.getClass().getResourceAsStream(&quot;/redis-config.properties&quot;);</span><br><span class="line">		Properties properties = new Properties();</span><br><span class="line">		properties.load(inputStream);</span><br><span class="line">		JedisPoolConfig config = new JedisPoolConfig();</span><br><span class="line">		config.setMaxTotal(Integer.valueOf(properties.getProperty(&quot;maxActive&quot;)));</span><br><span class="line">		config.setMaxIdle(Integer.valueOf(properties.getProperty(&quot;MaxIdle&quot;)));</span><br><span class="line">		config.setMaxWaitMillis(Long.valueOf(properties.getProperty(&quot;maxWait&quot;)));</span><br><span class="line">		config.setTestOnBorrow(Boolean.valueOf(properties.getProperty(&quot;testOnBorrow&quot;)));</span><br><span class="line">		String[] address = properties.getProperty(&quot;ip&quot;).split(&quot;:&quot;);</span><br><span class="line">		JedisPool pool = new JedisPool(config,address[0],Integer.valueOf(address[1]),Integer.valueOf(properties.getProperty(&quot;timeout&quot;)));</span><br><span class="line">		return pool;</span><br><span class="line">	&#125;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://banyibu.com/2018/12/25/NoSQL第七章-键值数据库Redis入门/" data-id="cjt5tw50800eyczo3e91qbzsb" class="article-share-link">分享</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NoSQL/">NoSQL</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据库/">数据库</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/12/26/Docker-基本操作/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">
        
          Docker-基本操作
        
      </div>
    </a>
  
  
    <a href="/2018/12/25/NoSQL第六章-MongoDB案例实战/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">NoSQL第六章-MongoDB案例实战</div>
    </a>
  
</nav>

  
</article>






  <div id="comments" class="comments">
  	<div id="uyan_frame"></div>
  </div>
	<section class="livere" id="comments">
<!-- 来必力City版安装代码 -->
<div id="lv-container" data-id="city" data-uid="MTAyMC8zNzc5NS8xNDMyNg==">
<script type="text/javascript">
   (function(d, s) {
       var j, e = d.getElementsByTagName(s)[0];

       if (typeof LivereTower === 'function') { return; }

       j = d.createElement(s);
       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
       j.async = true;

       e.parentNode.insertBefore(j, e);
   })(document, 'script');
</script>
<noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
</div>
<!-- City版安装代码已完成 -->
</section>
	


</section>
        
          <aside id="sidebar">
  
    <div class="widget-wrap">
  <h3 class="widget-title"></h3>
  <div class="widget">
    <h1 class="blog-title">致良知，事上练</h1>
    <h2 class="blog-subtitle">偏爱精神世界的更新换代，日日思之，日日求突破。</h2>
    <ul class="blog-link">
     
          <a href="/" title="Home">
            <li>主页</li>
          </a>
        
          <a href="/archives" title="Archives">
            <li>归档</li>
          </a>
        
          <a href="/categories" title="Categories">
            <li>分类</li>
          </a>
        
          <a href="/tags" title="Tags">
            <li>标签</li>
          </a>
        
          <a href="/about" title="About">
            <li>关于</li>
          </a>
        
          <a href="/sponsor" title="Sponsor">
            <li>投喂</li>
          </a>
        
    </ul>
  </div>
</div>

  
    <div class="widget-wrap">
  <h3 class="widget-title"></h3>
  <div class="widget">
    <img class="avatar" src="https://upload-images.jianshu.io/upload_images/12985001-ffd8bc90edb9f3e9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
    <h2 class="author">般一不</h2>
    <h3 class="description"></h3>
    <div class="count-box">
      <a href="/archives"><div><strong>63</strong><br>文章</div></a>
      <a href="/categories"><div><strong>27</strong><br>分类</div></a>
      <a href="/tags"><div><strong>27</strong><br>标签</div></a>
    </div>



    <div class="social-link">
      
        <a class="hvr-bounce-in" href="http://github.com/banyibu" target="_blank" title="Github">
          Github
        </a>
      
    </div>

    <div class="friend-link">
      <h2>友情链接</h2>
      
        <a class="hvr-bounce-in" href="https://dadavision.cn" target="_blank" title="Dadavision">
          Dadavision
        </a>
      
        <a class="hvr-bounce-in" href="https://www.resultlv.com" target="_blank" title="Rwsultlv">
          Rwsultlv
        </a>
      
    </div>
  </div>
</div>



  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy;2018 - 2019 般一不<br>
      由<a href="http://hexo.io/" target="_blank">Hexo</a>强力驱动 | 
      主题-<a href="https://github.com/ShanaMaid/hexo-theme-shana">Ban Yibu</a>
      
    </div>
    
  </div>
</footer>
    </div>
    

<script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="//apps.bdimg.com/libs/wow/0.1.6/wow.min.js"></script>
<script>
new WOW().init();
</script>   


  <link rel="stylesheet" href="/plugin/fancybox/jquery.fancybox.css">
  <script src="/plugin/fancybox/jquery.fancybox.pack.js"></script>



  <link rel="stylesheet" href="/plugin/galmenu/GalMenu.css">
  <script src="/plugin/galmenu/GalMenu.js"></script>
  <div class="GalMenu GalDropDown">
      <div class="circle" id="gal">
        <div class="ring">
          
            <a href="/" title="" class="menuItem">首页</a>
          
            <a href="/tags" title="" class="menuItem">标签</a>
          
            <a href="/categories" title="" class="menuItem">分类</a>
          
            <a href="/archives" title="" class="menuItem">归档</a>
          
            <a href="/about" title="" class="menuItem">关于</a>
          
            <a href="/sponsor" title="" class="menuItem">打赏</a>
          
        </div>
        
          <audio id="audio" src="#"></audio>
        
      </div> 
</div>
<div id="overlay" style="opacity: 1; cursor: pointer;"></div>
  <script type="text/javascript">var items = document.querySelectorAll('.menuItem');
    for (var i = 0,
    l = items.length; i < l; i++) {
      items[i].style.left = (50 - 35 * Math.cos( - 0.5 * Math.PI - 2 * (1 / l) * i * Math.PI)).toFixed(4) + "%";
      items[i].style.top = (50 + 35 * Math.sin( - 0.5 * Math.PI - 2 * (1 / l) * i * Math.PI)).toFixed(4) + "%"
    }</script>
<script type="text/javascript">
  $(document).ready(function() {
    $('body').GalMenu({
      'menu': 'GalDropDown'
    })
  });
</script>

  <section class="hidden-xs"> 
  <ul class="cb-slideshow"> 
    <li><span>苟利</span></li> 
    <li><span>国家</span></li> 
    <li><span>生死以</span></li> 
    <li><span>岂能</span></li> 
    <li><span>祸福</span></li> 
    <li><span>趋避之</span></li> 
  </ul>
</section>
<script src="/js/script.js"></script>



  </div>
</body>
</html>